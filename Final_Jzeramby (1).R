---
title: 'Final Project: BIO 539'
author: "Jessica Zeramby"
date: "7/29/2021"
output:
  html_document:
    df_print: paged
  latex_engine: xelatex
  pdf_document: default
---
```{r, setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
```

```{r, load data, include=FALSE}
library(tidyverse)
library(ggplot2)
library(tidyr)
library(plotly)
library(scales)
library(readr)
library(data.table)
library(lubridate)
library(flextable)
library(gridExtra)
library(maps)
#library(mapdata)
library(viridis)
library(ggrepel)
library(dplyr)

#uploading raw data files as CSV files
X2014Records <- read_csv("2014Records.csv")
X2016Records <- read_csv("2016Records.csv")
X2018Records <- read_csv("2018Records.csv")
X2019Records <- read_csv("2019Records.csv")
Intakebytown_mappingdata <- read_csv("Top intake Towns WRARI csv.csv")

#install.packages(c('tinytex', 'rmarkdown'))
#tinytex::install_tinytex()
```

#               An Exploratory Data Analysis of Wildlife Rehabilitation Records

## Introduction 

In recent decades, there has been a surge in interest in studies of human-wildlife conflicts as scientists have become more aware of their importance. According to new research in this field, there may be an underutilized and often overlooked data source that has the potential to provide critical information for understanding human-wildlife interactions that lead to conflicts. Admission records from wildlife rehabilitation facilities, according to modern scholars, could be the tool they've been looking for to characterize human impacts on wildlife and better understand human-wildlife conflicts. The following analysis was performed to provide evidence in support of this theory.

The Wildlife Rehabilitators Association of Rhode Island, or WRARI, is a non-profit organization based in Rhode Island that promotes understanding, education, and respect for all Rhode Island wildlife. The WRARI headquarters, located in southern Rhode Island, also serves as the state's only fully operational wildlife veterinary clinic. The wildlife clinic has taken in thousands of injured, orphaned, and displaced wildlife in need of veterinary care over the last twenty-five years and worked to rehabilitate them for successful release back into the wild. The WRARI and RI wildlife clinic staff gave permission for the following analysis to be performed using their annual wildlife intake records from 2014, 2016, 2018, and 2019. They provided annual wildlife admission records for each of the four years of data used in this analysis, with each file containing spreadsheet data logging every animal admitted to the facility that year.

## Research Objectives
The following analysis was centered on four key questions:

1.	What are the most common sources of wildlife injury in Rhode Island?
2.	Which species in Rhode Island are the most threatened or vulnerable?
3.	How many wild animals are admitted to this facility on a regular basis, or what is the average number of wildlife intakes to this facility?
4.	Which Rhode Island locations, if any, serve as hotspots for wildlife injury or displacement?

*At the request of the data source, some information was omitted from the following data files prior to inclusion in this analysis. Any personal or private information, as well as any information that is not publicly available, has been excluded from the following data sets.*

\newpage

## Data Analysis
To begin, each set of annual wildlife admission records was evaluated individually, beginning with the first year of available data, 2014, and ending with the most recent year of available data, 2019.

### **2014 Wildlife Admission Records**

The 2014 wildlife admission records were first analyzed to calculate the number of clinic admissions for each month of the year.

**2014 Monthly Admissions:**
```{r, warning=FALSE}
#starting with 2014 data
#clean 2014 data
Records_14 <- rename(X2014Records, date = "Intake Date", species_class = "Species Class", species = "Species", specific_location = "Specific Location", city = "City Found", cause_for_admission = "Cause for Admission")
#extract important columns
Records_14 <- select(Records_14, c(1,2,3,7,8,9))

#change date format for 2014 
Records_14 <- Records_14 %>%
mutate(date = mdy(date))

#Add month column from date column for 2014
Records_14$month <- month(Records_14$date)

#remove NA for 2014 data
Records_14 <- Records_14 %>%
  filter(!is.na(date))
```

```{r, include=FALSE}
#plotting the intakes each month against months in the year 2014
updated_14_intakebymonth <- ggplot(Records_14) + aes(x = month(month, label = TRUE)) + 
  geom_bar(fill = "#0099f9") +
  labs(x = "Month", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 13, face = "bold", margin = margin(6, 6, 6, 6), hjust = 0.5), plot.caption =  element_text(face = "bold", hjust = 0.5, vjust = -0.6)) +
  theme(axis.text.x = element_text(size = 9, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 9)) +
  theme(axis.title.x = element_text(vjust =-0.55)) +
  theme(axis.title.y = element_text(vjust =0.55)) +
  labs(title = "Monthly Wildlife Admissions in 2014", caption = "Figure 1: The number of monthly admissions to the wildlife clinic in 2014.")
updated_14_intakebymonth 
#Figure 1: Monthly admissions to the wildlife clinic in 2014.
```

```{r, include = FALSE}
#calculate total intakes per month in tibble for 2014 intakes
#monthly total caluclations for intakes admission 
Monthlystats_14 <- Records_14 %>%
  group_by(month) %>%
  tally()

#count monthly intakes in 2014 
Monthlystats_14 <- Records_14 %>%
  group_by(month) %>%
  summarise(count = n()) %>%
  na.omit("Monthlystats_14") %>%
  top_n(12)

#statistics of monthly 2014 admissions 
mean(Monthlystats_14$count)
#mean of monthly intakes = 177, meaning the average monthly intake in 2014 is 177 intakes per month

min(Monthlystats_14$count)
#minimum intake per month = 41, meaning the lowest number of monthly intakes in 2014 was 41 intakes in a month

max(Monthlystats_14$count)
#maximum intake per month = 458, meaning the maximum number of intakes in a month in 2014 was 458 intakes in a month

median(Monthlystats_14$count)
#median intake per month = 111, meaning of the range for monthly intakes in 2014 the middle number of intakes is 111 intakes in a month

#tibble of monthly intakes, convert numeric month format to abbreviated month 
Monthlystats_14$month <- (month.abb[Monthlystats_14$month])

#convert monthly stats 14 tibble into data frame
Monthlystats_14_table <- data.frame(Monthlystats_14)

#convert monthly stats 14 data frame into table
setDT(Monthlystats_14_table)

#check if this was sucessful in turning data frame into data table 
is.data.table(Monthlystats_14_table)

#rename columns in data table
setnames(Monthlystats_14_table, c("month","count"), c("Month", "Admissions"))

#use flextable package
Monthlystats_14_tableflex <- flextable(Monthlystats_14_table)

#format table
Monthlystats_14_tableflex <- theme_vanilla(Monthlystats_14_tableflex)
Monthlystats_14_tableflex <- border_outer(Monthlystats_14_tableflex)
Monthlystats_14_tableflex <- border_inner_v(Monthlystats_14_tableflex)
Monthlystats_14_tableflex <- set_caption(Monthlystats_14_tableflex, "The number of monthly admissions to the wildlife clinic in 2014.")
#Table 1: Monthly Admissions to the wildlife clinic in 2014
```

```{r}
Monthlystats_14_tableflex
```

```{r}
updated_14_intakebymonth
```

**Results: **

According to these results, the average number of monthly intakes in 2014 was 177 total intakes per month. The month of June had the highest number of intakes in a single month, with 458 total intakes, followed by July, which had the second highest number of intakes per month for the year, with 374 total intakes. After peaking in the summer, the number of monthly intakes began to decline. Admissions fell steadily throughout October and November, reaching a winter low of 41 intakes in December, 56 in January, and 46 in February. According to these patterns, the number of wildlife admissions to this facility appears to follow seasonal trends.

Following this, the 2014 intake records were analyzed to determine the top five reasons for wildlife clinic admissions this year.

**2014 Top Five Reasons for Admission:**
```{r, include=FALSE}
#begin analysis for determining top reasons for admission

#check class for cause for admission column before replacing values
class(Records_14$cause_for_admission)

#replace values to fix spelling and grammar errors
#replace "orphaned" with "Orphaned" to match other variables of the same kind
Records_14$cause_for_admission <- gsub('orphaned', 'Orphaned', Records_14$cause_for_admission)

#replace "injured" with "Unkonwn trauma" to match other variables of the same kind
Records_14$cause_for_admission <- gsub('Injured', 'Unknown trauma', Records_14$cause_for_admission)

#top reasons for admission 2014 
admissions_2014 <- Records_14 %>%
  group_by(date, cause_for_admission) %>%
  tally()

#count frequency of reasons for admission in 2014
admissions_2014 <- na.omit("admissions_2014") 
admissions_2014_count <- Records_14 %>%
  group_by(cause_for_admission) %>%
  summarise(count = n())

#count top 5 common reasons for admission in 2014
admissions_2014 <- na.omit("admissions_2014") 
admissions_2014 <- Records_14 %>%
  group_by(cause_for_admission) %>%
  summarise(count = n()) %>%
  na.omit("admissions_2014") %>%
  top_n(5) 

#plot top 5 common reasons for admission in 2014
#plot in descending order on x axis
#\n seperates label or title into next line
#added formatting code to axis, title, caption and labels
top5_admissions14_plot <- ggplot(data = admissions_2014, aes(x = reorder(cause_for_admission, -count), y = count)) + 
  geom_bar(stat = "identity", fill = "#69b3a2") +
  labs(x = "Reason for Admission", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 13, face = "bold", margin = margin(6, 6, 6, 6), hjust = 0.5), 
        plot.caption = element_text(face = "bold", hjust = 0.5, vjust = -0.6)) +
  theme(axis.text.x = element_text(size = 9, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 9)) +
  theme(axis.title.x = element_text(vjust =-0.55)) +
  theme(axis.title.y = element_text(vjust =0.55)) +
  labs(title = "Top Five Reasons for Admission in 2014", caption = "Figure 2: The total number of admissions for each of the \n top five reasons for admission to the wildlife clinic in 2014.")
top5_admissions14_plot
#Figure 2: Total number of admissions for each of the top five reasons for admission to the wildlife clinic in 2014 
```

```{r, include=FALSE, warning=FALSE}
#making the top5reasonsforadmission2014 in a table format
#make table with top 5 reasons, count, and percentage of total 

#arrange data frame into descending order
admissions_2014 <- admissions_2014 %>%
  arrange(desc(count))

#add percent to admissions14 table
admissions_2014 <- admissions_2014 %>%
  mutate(admissions_2014, Percent_total_intakes = count / sum (admissions_2014_count$count) * 100) 

#convert admissions 14 tibble into data frame
top5_rzn14_table <- data.frame(admissions_2014)

#convert admissions 14 data frame into table
setDT(top5_rzn14_table)

#check if this was sucessful in turning data frame into data table 
is.data.table(top5_rzn14_table)

#rename columns in data table
setnames(top5_rzn14_table, c("cause_for_admission","count", "Percent_total_intakes"), 
         c("Reason Admitted", "Number of Admissions", "Percent of Total Admissions"))

#round percent column to whole numbers
top5_rzn14_table$`Percent of Total Admissions` <- round(top5_rzn14_table$`Percent of Total Admissions`)

#use flextable package
top5_rzn14_tableflex <- flextable(top5_rzn14_table)

#format table
#adjust dimensions to autofit
top5_rzn14_tableflex <- top5_rzn14_tableflex %>%
  autofit(add_w = 0, add_h = 0)

#format table
top5_rzn14_tableflex <- theme_vanilla(top5_rzn14_tableflex)
top5_rzn14_tableflex <- border_outer(top5_rzn14_tableflex)
top5_rzn14_tableflex <- set_caption(top5_rzn14_tableflex, "The total number of admissions and percentage of total admissions for each of the top five reasons for admission in 2014.")
top5_rzn14_tableflex

#stats for top reasons for admission data (2014)
sum(top5_rzn14_table$`Number of Admissions`)
#top 5 reasons account for 1711 intakes of the 2133 total admissions for the year 2014
#top 5 reasons for intake account for 80% of all intakes that year
#Table 2: The total number of admissions and percentage of total admissions for each of the top five reasons for admission in 2014.**
```

```{r, warning=FALSE}
top5_rzn14_tableflex
```

```{r}
top5_admissions14_plot
```

**Results:**

According to these findings, In 2014, the top five reasons for admission to the wildlife clinic accounted for 1,711 of the 2,133 total intakes, or 80 percent of all intakes. Therefore, the top five reasons for admission accounted for more than three-quarters of all clinic admissions in 2014. The most common reason for admission in this year was orphaned wildlife (38%), followed by cases of unknown injuries or trauma (29%), attacks on wildlife by domestic cats (6%), incidents involving animal-vehicle collisions (4%), and attacks on wildlife by domestic dogs (2%). 

In the following and final segment of the 2014 individual year data analysis, the top five species that were the most severely impacted and thus frequently admitted to the clinic in 2014 were evaluated.

**2014 Top Five Most Frequently Admitted Species:**
```{r, include=FALSE}
#begin analysis for top 5 most common species admitted in 2014 
#count top 5 most common species admitted in 2014

#top species admitted 2014 
topspecies_2014 <- Records_14 %>%
  group_by(species) %>%
  tally()

#count freq of all different species admitted in 2014
topspecies_2014 <- na.omit("topspecies_2014") 
topspecies_2014_count <- Records_14 %>%
  group_by(species) %>%
  summarise(count = n())

#count top 5 most common species admitted in 2014
topspecies_2014 <- na.omit("topspecies_2014") 
topspecies_2014 <- Records_14 %>%
  group_by(species) %>%
  summarise(count = n()) %>%
  na.omit("topspecies_2014") %>%
  top_n(5)
topspecies_2014

#plot top 5 species admitted in 2014
#plot in descending order on x axis
#\n seperates label or title into next line
#added formatting code to axis, title, caption and labels

top5_species14_plot <- ggplot(data = topspecies_2014, aes(x = reorder(species, -count), y = count)) + 
  geom_bar(stat = "identity", fill = "#CC3300") +
  labs(x = "Species", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 13, face = "bold", margin = margin(6, 6, 6, 6), hjust = 0.5),  plot.caption = element_text(face = "bold", hjust = 0.5, vjust = -0.8)) +
  theme(axis.text.x = element_text(size = 7, face = "bold", vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 9)) +
  theme(axis.title.x = element_text(vjust =-0.55)) +
  theme(axis.title.y = element_text(vjust =0.55)) +
  labs(title = "Top Five Most Frequently Admitted Species in 2014", caption = "Figure 3: The top five most frequently admitted species in 2014\n and the total number of clinic admissions for each.")
saveRDS(top5_species14_plot, file = "top5_species14_plot.RDS")
save(top5_species14_plot, file = "top5_species14_plot.RData")
top5_species14_plot
#Figure 3: The top five most frequently admitted species in 2014 and the total number of clinic admissions for each.
```

```{r, include=FALSE}
#making top 5 species table with top 5 species, number admissions (count), and percent total admissions

#arrange tibble into descending order
topspecies_2014 <- topspecies_2014 %>%
  arrange(desc(count))

#add percent to tibble
topspecies_2014 <- topspecies_2014 %>%
  mutate(topspecies_2014, 'Percent of Total Admissions' = count / sum (topspecies_2014_count$count) * 100) 
topspecies_2014

#convert top species tibble into data frame
top5_species14_table <- data.frame(topspecies_2014)

#convert admissions 14 data frame into table
setDT(top5_species14_table)

#check if this was sucessful in turning data frame into data table 
is.data.table(top5_species14_table)

#rename columns in data table
setnames(top5_species14_table, c("species","count", "Percent.of.Total.Admissions"), 
         c("Species", "Number of Admissions", "Percent of Total Admissions"))

#round percent column to whole numbers
top5_species14_table$`Percent of Total Admissions` <- round(top5_species14_table$`Percent of Total Admissions`)

#use flextable package
top5_species14_tableflex <- flextable(top5_species14_table)

#format table
#adjust dimensions to autofit
top5_species14_tableflex <- top5_species14_tableflex %>%
  autofit(add_w = 0, add_h = 0)

#format table
top5_species14_tableflex <- theme_vanilla(top5_species14_tableflex)
top5_species14_tableflex <- border_outer(top5_species14_tableflex)
top5_species14_tableflex <- set_caption(top5_species14_tableflex, "The number of admissions and percent of total admissions for the top five most frequently admitted species in 2014.")
top5_species14_tableflex

#stats for top species (2014)
#sum of admissions from all top 5 common species combined
sum(top5_species14_table$'Number of Admissions')
#961 admissions
#961 of 2133 total admissions in 2014 are from top 5 species,
#top 5 species = 45% of all admissions in 2014

#compare admissions from top 5 species with total number of species admitted in 2014
Number_diffspecies_2014_forstats<- Records_14 %>%
  count(species)
#168
#168 different species admitted in 2014
#168 species total. Top 5 most commonly admitted species = almost 50% of all admissions
#Table 3: The number of admissions and percent of total admissions for the top five most frequently admitted species in 2014.**
```

```{r, warning=FALSE}
top5_species14_tableflex
```

```{r}
top5_species14_plot
```

**Results:**

According to these results, the top five most commonly admitted species accounted for 961 of the 2,133 total intakes in 2014, or 45 percent of all intakes in 2014. The Eastern Cotton Tail was the most frequently admitted species, accounting for 16% of all admissions, followed by the Eastern Grey Squirrel (10%), the House Sparrow (8%), the American Robin (8%), and the Rock Dove (3%). According to these findings, of the 168 different species admitted to the clinic in 2014, the top five most frequently admitted species accounted for nearly half of all admissions.

**After calculating the number of monthly wildlife admissions, identifying the top five reasons for admission to the clinic, and determining the top five most frequently admitted species over the course of the year, the portion of this analysis specific to the 2014 yearly intake records was completed. The second stage of this investigation involved a similar examination of 2016 wildlife admission records.**

\newpage

### 2016 Wildlife Admission Records

To begin the analysis of the 2016 wildlife admissions data, the number of intakes to the clinic in each month of the year was determined.


**2016 Monthly Admissions:**
```{r, include=FALSE}
#Begin 2016 data analysis
#repeat steps above for 2016, clean, # of intakes, top 5 admission reasons, top 5 species admitted

#getinfoabout2016
summary(X2016Records)
X2016Records

#extract important columns only
Records_16<- select(X2016Records, c(1,2,3,8,9))

#clean data 2016
Records_16 <- rename(Records_16, date = "Intake Date", species_class = "Species Class", species = "Species", city = "City Found", cause_for_admission = "Cause for Admission")

#change date format for 2016 
Records_16 <- Records_16 %>%
mutate(date = mdy(date))

#Add month column from date column for 2016
Records_16$month <- month(Records_16$date)

#remove NA for 2016 data
Records_16 <- Records_16 %>%
  filter(!is.na(date))

#plotting the intakes each month against months in the year 2016
Intakebymonth_16 <- ggplot(Records_16) + aes(x = month(month, label = TRUE)) +
  geom_bar(fill = "#0099f9") +
  labs(x = "Month", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 13, face = "bold", margin = margin(6, 6, 6, 6), hjust = 0.5), plot.caption =  element_text(face = "bold", hjust = 0.5, vjust = -0.6)) +
  theme(axis.text.x = element_text(size = 9, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 9)) +
  theme(axis.title.x = element_text(vjust =-0.55)) +
  theme(axis.title.y = element_text(vjust =0.55)) +
  labs(title = "Monthly Wildlife Admissions in 2016", caption = "Figure 4: The number of monthly admissions to the wildlife clinic in 2016.")
Intakebymonth_16
#Figure 4: Monthly admissions to the wildlife clinic in 2016
```

```{r, include=FALSE}
#2016 intake by month data into table 

#calculate total intakes per month in tibble for 2016 intakes
#monthly total calculations for intakes admission 
Monthlystats_16 <- Records_16 %>%
  group_by(month) %>%
  tally()

#count monthly intakes in 2016 
Monthlystats_16 <- Records_16 %>%
  group_by(month) %>%
  summarise(count = n()) %>%
  na.omit("Monthlystats_16") %>%
  top_n(12)

#statistics of monthly 2016 admissions 
mean(Monthlystats_16$count)
#mean of monthly intakes = 233, meaning the average monthly intake in 2016 is 233 intakes per month

min(Monthlystats_16$count)
#minimum intake per month = 38, meaning the lowest number of monthly intakes in 2016 was 38 intakes in a month

max(Monthlystats_16$count)
#maximum intake per month = 607, meaning the maxmimum number of intakes in a month in 2016 was 607 intakes in a month

median(Monthlystats_16$count)
#median intake per month = 185, meaning of the range for monthly intakes in 2016 the middle number of intakes is 185 intakes in a month

#tibble of monthly intakes, convert numeric month format to abbreviated month 
Monthlystats_16$month <- (month.abb[Monthlystats_16$month])

#convert monthly stats 16 tibble into data frame
Monthlystats_16_table <- data.frame(Monthlystats_16)

#convert monthly stats 16 data frame into table
setDT(Monthlystats_16_table)

#check if this was sucessful in turning data frame into data table 
is.data.table(Monthlystats_16_table)

#rename columns in data table
setnames(Monthlystats_16_table, c("month","count"), c("Month", "Admissions"))

#use flextable package
Monthlystats_16_tableflex <- flextable(Monthlystats_16_table)

#format table
Monthlystats_16_tableflex <- theme_vanilla(Monthlystats_16_tableflex)
Monthlystats_16_tableflex <- border_outer(Monthlystats_16_tableflex)
Monthlystats_16_tableflex <- border_inner_v(Monthlystats_16_tableflex)
Monthlystats_16_tableflex <- set_caption(Monthlystats_16_tableflex, "The number of monthly admissions to the wildlife clinic in 2016.")
Monthlystats_16_tableflex
#Table 4: Monthly Admissions to the wildlife clinic in 2016
```

```{r}
Monthlystats_16_tableflex
```

```{r}
Intakebymonth_16
```


**Results:**

Monthly admissions trends in 2016 appeared to follow seasonal patterns similar to those observed in 2014. Clinic admissions peaked once again between May and August, with June and July continuing to be the busiest months for wildlife admissions, with 607 and 441 admissions per month, respectively. The highest number of admissions in a single month was 607, and the lowest number of admissions in a single month was 38. The total number of admissions per month in 2016 was 233 on average across all months. As shown in Figure 4, the number of monthly admissions decreased steadily from late summer to early fall. Admissions then fell to their lowest point of the year in the winter months of December and January, with only 38 and 48 intakes, respectively, and remained at a steady, relatively low admissions rate throughout the winter.

Following these findings, the 2016 intake records were assessed to determine the top five most common reasons for clinic admission this year.
\newpage

**2016 Top Five Reasons for Admission:**
```{r, include=FALSE}
#begin analysis for determining top reasons for admission 2016

#check class for cause for admission column before replacing values
class(Records_16$cause_for_admission)

#replace values to fix spelling and grammar errors
#replace "Orphaned Juvenile" with "Orphaned" to match other variables of the same kind
Records_16$cause_for_admission <- gsub('Orphaned juvenile', 'Orphaned', Records_16$cause_for_admission)

#replace "injury" with "Unknown trauma" to match other variables of the same kind
Records_16$cause_for_admission <- gsub('Injury', 'Unknown trauma', Records_16$cause_for_admission)

#replace "HBC" with "Hit by car" to match other variables of the same kind
Records_16$cause_for_admission <- gsub('HBC', 'Hit by car', Records_16$cause_for_admission)

#replace "Cat caught" with "Cat attack" to match other variables of the same kind
Records_16$cause_for_admission <- gsub('Cat caught', 'Cat attack', Records_16$cause_for_admission)

#top reasons for admission 2016 
admissions_2016 <- Records_16 %>%
  group_by(date, cause_for_admission) %>%
  tally()

#count freq of reasons for admission in 2016
admissions_2016 <- na.omit("admissions_2016") 
admissions_2016_count <- Records_16 %>%
  group_by(cause_for_admission) %>%
  summarise(count = n())

#count top 5 common reasons for admission in 2016
admissions_2016 <- na.omit("admissions_2016") 
admissions_2016 <- Records_16 %>%
  group_by(cause_for_admission) %>%
  summarise(count = n()) %>%
  na.omit("admissions_2016") %>%
  top_n(5) 
admissions_2016

#plot top 5 common reasons for admission in 2016
#plot in descending order on x axis
#\n seperates label or title into next line
#added formatting code to axis, title, caption and labels
top5_admissions16_plot <- ggplot(data = admissions_2016, aes(x = reorder(cause_for_admission, -count), y = count)) + 
  geom_bar(stat = "identity", fill = "#69b3a2") +
  labs(x = "Reason for Admission", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 13, face = "bold", margin = margin(6, 6, 6, 6), hjust = 0.5), plot.caption = element_text(face = "bold", hjust = 0.5, vjust = -0.6)) +
  theme(axis.text.x = element_text(size = 9, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 9)) +
  theme(axis.title.x = element_text(vjust =-0.55)) +
  theme(axis.title.y = element_text(vjust =0.55)) +
  labs(title = "Top Five Reasons for Admission in 2016", caption = "Figure 5: The total number of admissions for each of the \n top five reasons for admission to the wildlife clinic in 2016")
top5_admissions16_plot
#Figure 5: Total number of admissions for each of the top five reasons for admission to the wildlife clinic in 2016.
```

```{r, include=FALSE}
#making the top5reasonsforadmission2016 in a table format
#make table with top 5 reasons, count, and percentage of total 

#arrange data frame into descending order
admissions_2016 <- admissions_2016 %>%
  arrange(desc(count))
#add percent to admissions16 table
admissions_2016 <- admissions_2016 %>%
  mutate(admissions_2016, Percent_total_intakes = count / sum (admissions_2016_count$count) * 100) 
admissions_2016

#convert admissions 16 tibble into data frame
top5_rzn16_table <- data.frame(admissions_2016)

#convert admissions 16 data frame into table
setDT(top5_rzn16_table)

#check if this was sucessful in turning data frame into data table 
is.data.table(top5_rzn16_table)

#rename columns in data table
setnames(top5_rzn16_table, c("cause_for_admission","count", "Percent_total_intakes"), 
         c("Reason Admitted", "Number of Admissions", "Percent of Total Admissions"))

#round percent column to whole numbers
top5_rzn16_table$`Percent of Total Admissions` <- round(top5_rzn16_table$`Percent of Total Admissions`)

#use flextable package
top5_rzn16_tableflex <- flextable(top5_rzn16_table)

#format table
#adjust dimensions to autofit
top5_rzn16_tableflex <- top5_rzn16_tableflex %>%
  autofit(add_w = 0, add_h = 0)

#format table
top5_rzn16_tableflex <- theme_vanilla(top5_rzn16_tableflex)
top5_rzn16_tableflex <- border_outer(top5_rzn16_tableflex)
top5_rzn16_tableflex<- set_caption(top5_rzn16_tableflex, "The total number of admissions and percentage of total admissions for each of the top five reasons for admission in 2016.")

#stats for top reasons for admission data (2016)
sum(top5_rzn16_table$`Number of Admissions`)
#top 5 reasons account for 1064 intakes of the 2797 total admissions for the year 2016
#top 5 reasons for intake account for 38% of all intakes that year
top5_rzn16_tableflex
#Table 5: The total number of admissions and percentage of total admissions for each of the top five reasons for admission in 2016.
```

```{r}
top5_rzn16_tableflex
```

```{r}
top5_admissions16_plot
```



**Results:**

The five primary reasons for admission to the wildlife clinic accounted for 1,064 of the 2,797 total intakes in 2016, or 38% of all intakes. According to these calculations, the most common reason for admission to the clinic in 2016 was wildlife orphanage (27%), followed by cases of unknown injuries or trauma (5%), attacks on wildlife by domestic cats (3%), incidents involving animal-vehicle collisions (2%), and injuries to wildlife resulting in broken wings (1%).

The next and final step in the 2016 intake record data analysis was to identify the top five species admitted to the clinic this year.

**2016 Top Five Most Frequently Admitted Species:**
```{r, include=FALSE}
#begin analysis for top 5 most common species admitted in 2016
#count top 5 most common species admitted in 2016

#top species admitted 2016 
topspecies_2016<- Records_16 %>%
  group_by(species) %>%
  tally()

#count freq of all different species admitted in 2016
topspecies_2016 <- na.omit("topspecies_2016") 
topspecies_2016_count <- Records_16 %>%
  group_by(species) %>%
  summarise(count = n())

#count top 5 most common species admitted in 2016
topspecies_2016 <- na.omit("topspecies_2016") 
topspecies_2016 <- Records_16 %>%
  group_by(species) %>%
  summarise(count = n()) %>%
  na.omit("topspecies_2016") %>%
  top_n(5)
topspecies_2016

#plot top 5 species admitted in 2016
#plot in descending order on x axis
#\n seperates label or title into next line
#added formatting code to axis, title, caption and labels

top5_species16_plot <- ggplot(data = topspecies_2016, aes(x = reorder(species, -count), y = count)) + 
  geom_bar(stat = "identity", fill = "#CC3300") +
  labs(x = "Species", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 13, face = "bold", margin = margin(6, 6, 6, 6), hjust = 0.5),  plot.caption = element_text(face = "bold", hjust = 0.5, vjust = -0.8)) +
  theme(axis.text.x = element_text(size = 7, face = "bold", vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 9)) +
  theme(axis.title.x = element_text(vjust =-0.55)) +
  theme(axis.title.y = element_text(vjust =0.55)) +
  labs(title = "Top Five Most Frequently Admitted Species in 2016", caption = "Figure 6: The top five most frequently admitted species in 2016\n and the total number of clinic admissions for each.")
saveRDS(top5_species16_plot, file = "top5_species16_plot.RDS")
save(top5_species16_plot, file = "top5_species16_plot.RData")
top5_species16_plot
#Figure 6: The top five most frequently admitted species in 2016 and the total number of clinic admissions for each
```

```{r, include=FALSE}
#making top 5 species table with top 5 species, number admissions (count), and percent total admissions

#arrange tibble into descending order
topspecies_2016 <- topspecies_2016 %>%
  arrange(desc(count))

#add percent to tibble
topspecies_2016 <- topspecies_2016 %>%
  mutate(topspecies_2016, 'Percent of Total Admissions' = count / sum (topspecies_2016_count$count) * 100) 
topspecies_2016

#convert top species tibble into data frame
top5_species16_table <- data.frame(topspecies_2016)

#convert admissions 16 data frame into table
setDT(top5_species16_table)

#check if this was sucessful in turning data frame into data table 
is.data.table(top5_species16_table)

#rename columns in data table
setnames(top5_species16_table, c("species","count", "Percent.of.Total.Admissions"), 
         c("Species", "Number of Admissions", "Percent of Total Admissions"))

#round percent column to whole numbers
top5_species16_table$`Percent of Total Admissions` <- round(top5_species16_table$`Percent of Total Admissions`)

#use flextable package
top5_species16_tableflex <- flextable(top5_species16_table)

#format table
#adjust dimensions to autofit
top5_species16_tableflex <- top5_species16_tableflex %>%
  autofit(add_w = 0, add_h = 0)

#format table
top5_species16_tableflex <- theme_vanilla(top5_species16_tableflex)
top5_species16_tableflex <- border_outer(top5_species16_tableflex)
top5_species16_tableflex <- set_caption(top5_species16_tableflex, "The number of admissions and percent of total admissions for the top five most frequently admitted species in 2016.")

#stats for top species (2016)

#sum of admissions from all top 5 common species combined
sum(top5_species16_table$'Number of Admissions')
#1069 admissions
#1069 of 2797 total admissions in 2016 are from top 5 species,
#top 5 species = 38% of all admissions in 2016

#compare admissions from top 5 species with total number of species admitted in 2016
Number_diffspecies_2016_forstats<- Records_16 %>%
  count(species)
Number_diffspecies_2016_forstats
#272
#272 different species admitted in 2016
#272 species total. Top 5 most commonly admitted species = almost 40% of all admissions

top5_species16_tableflex 
#Table 6: The number of admissions and percent of total admissions for the top five most frequently admitted species in 2016.
```

```{r}
top5_species16_tableflex
```

```{r}
top5_species16_plot
```

**Results:**

According to these findings, the top five most commonly admitted species accounted for 1,069 of the 2,797 total intakes, or nearly 40% of all intakes in 2016. The Eastern Cotton Tail was once again the most commonly encountered species at the clinic, accounting for 13% of all admissions, followed by the Eastern Grey Squirrel (9%), the House Sparrow (7%), the American Robin (6%), and the Mourning Dove (3%).  Out of the 272 different species admitted to the clinic in 2016, these top five species accounted for nearly 40% of all admissions in this year.

**After calculating the number of monthly admissions and identifying the top five reasons for admission to the clinic as well as the five most frequently admitted species in the 2016 admissions analysis, the 2018 admission records were examined.**

### 2018 Wildlife Admission Records

The first step in analyzing the 2018 wildlife admission records was to determine the number of monthly admissions over the course of the year.

**2018 Monthly Admissions:**

```{r, include=FALSE}
#Begin 2018 data analysis
#repeat steps above for 2018, clean, # of intakes, top 5 admission reasons, top 5 species admitted

#extract important columns only
Records_18<- select(X2018Records, c(1,2,3,8,9))

#clean data 2018
Records_18 <- rename(Records_18, date = "Intake Date", species_class = "Species Class", species = "Species", city = "City Found", cause_for_admission = "Cause for Admission")

#change date format for 2018
Records_18 <- Records_18 %>%
mutate(date = mdy(date))

#Add month column from date column for 2018
Records_18$month <- month(Records_18$date)

#remove NA for 2018 data
Records_18 <- Records_18 %>%
  filter(!is.na(date))

#plotting the intakes each month against months in the year 2018
Intakebymonth_18 <- ggplot(Records_18) + aes(x = month(month, label = TRUE)) +
  geom_bar(fill = "#0099f9") +
  labs(x = "Month", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 13, face = "bold", margin = margin(6, 6, 6, 6), hjust = 0.5), plot.caption =  element_text(face = "bold", hjust = 0.5, vjust = -0.6)) +
  theme(axis.text.x = element_text(size = 9, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 9)) +
  theme(axis.title.x = element_text(vjust =-0.55)) +
  theme(axis.title.y = element_text(vjust =0.55)) +
  labs(title = "Monthly Wildlife Admissions in 2018", caption = "Figure 7: The number of monthly admissions to the wildlife clinic in 2018.")
Intakebymonth_18
#Figure 7: Monthly admissions to the wildlife clinic in 2018
```

```{r, include=FALSE}
#2018 intake by month data into table 

#calculate total intakes per month in tibble for 2018 intakes
#monthly total calculations for intakes admission 
Monthlystats_18 <- Records_18 %>%
  group_by(month) %>%
  tally()

#count monthly intakes in 2018 
Monthlystats_18 <- Records_18 %>%
  group_by(month) %>%
  summarise(count = n()) %>%
  na.omit("Monthlystats_18") %>%
  top_n(12)

#statistics of monthly 2018 admissions 

sum(Monthlystats_18$count)
#2626 total intakes in the year

mean(Monthlystats_18$count)
#mean of monthly intakes = 219, meaning the average monthly intake in 2018 is 219 intakes per month

min(Monthlystats_18$count)
#minimum intake per month = 48 , meaning the lowest number of monthly intakes in 2018 was 48  intakes in a month

max(Monthlystats_18$count)
#maximum intake per month = 507, meaning the maxmimum number of intakes in a month in 2018 was 507 intakes in a month

median(Monthlystats_18$count)
#median intake per month = 151, meaning of the range for monthly intakes in 2018 the middle number of intakes is 151 intakes in a month


#tibble of monthly intakes, convert numeric month format to abbreviated month 
Monthlystats_18$month <- (month.abb[Monthlystats_18$month])

#convert monthly stats 18 tibble into data frame
Monthlystats_18_table <- data.frame(Monthlystats_18)

#convert monthly stats 18 data frame into table
setDT(Monthlystats_18_table)

#check if this was sucessful in turning data frame into data table 
is.data.table(Monthlystats_18_table)

#rename columns in data table
setnames(Monthlystats_18_table, c("month","count"), c("Month", "Admissions"))

#use flextable package
Monthlystats_18_tableflex <- flextable(Monthlystats_18_table)

#format table
Monthlystats_18_tableflex <- theme_vanilla(Monthlystats_18_tableflex)
Monthlystats_18_tableflex <- border_outer(Monthlystats_18_tableflex)
Monthlystats_18_tableflex <- border_inner_v(Monthlystats_18_tableflex)
Monthlystats_18_tableflex <- set_caption(Monthlystats_18_tableflex, "The number of monthly admissions to the wildlife clinic in 2018.")
Monthlystats_18_tableflex
#Table 7: Monthly Admissions to the wildlife clinic in 2018
```

```{r}
Monthlystats_18_tableflex
```

```{r}
Intakebymonth_18
```

**Results:**

According to these findings, monthly admissions trends in 2018 followed seasonal patterns, as seen in previous years. Admission numbers peaked again between May and August, with June having the most total admissions, with 507 total admissions, and May and July coming in second, with 414 and 412 monthly admissions, respectively. While June had the most monthly admissions, February had the fewest, with only 46 admissions in the entire month. Monthly admission numbers averaged 218 total admissions per month.

Following this section of the analysis, the top five most common reasons for clinic admission in 2018 were next examined.

**2018 Top Five Reasons for Admission:**
```{r, include=FALSE}
#begin analysis for determining top reasons for admission 2018

#check class for cause for admission column before replacing values
class(Records_18$cause_for_admission)

#replace values to fix spelling and grammar errors
#replace "Orphaned Juvenile" with "Orphaned" to match other variables of the same kind
Records_18$cause_for_admission <- gsub('Orphaned juvenile', 'Orphaned', Records_18$cause_for_admission)

#replace "injury" with "Unknown trauma" to match other variables of the same kind
Records_18$cause_for_admission <- gsub('Injury', 'Unknown trauma', Records_18$cause_for_admission)

#replace "HBC" with "Hit by car" to match other variables of the same kind
Records_18$cause_for_admission <- gsub('HBC', 'Hit by car', Records_18$cause_for_admission)

#replace "Cat caught" with "Cat attack" to match other variables of the same kind
Records_18$cause_for_admission <- gsub('Cat caught', 'Cat attack', Records_18$cause_for_admission)

#top reasons for admission 2018
admissions_2018 <- Records_18 %>%
  group_by(date, cause_for_admission) %>%
  tally()

#count freq of reasons for admission in 2018
admissions_2018 <- na.omit("admissions_2018") 
admissions_2018_count <- Records_18 %>%
  group_by(cause_for_admission) %>%
  summarise(count = n())

#count top 5 common reasons for admission in 2018
admissions_2018 <- na.omit("admissions_2018") 
admissions_2018 <- Records_18 %>%
  group_by(cause_for_admission) %>%
  summarise(count = n()) %>%
  na.omit("admissions_2018") %>%
  top_n(5) 
admissions_2018

#plot top 5 common reasons for admission in 2018
#plot in descending order on x axis
#\n seperates label or title into next line
#added formatting code to axis, title, caption and labels
top5_admissions18_plot <- ggplot(data = admissions_2018, aes(x = reorder(cause_for_admission, -count), y = count)) + 
  geom_bar(stat = "identity", fill = "#69b3a2") +
  labs(x = "Reason for Admission", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 13, face = "bold", margin = margin(6, 6, 6, 6), hjust = 0.5), plot.caption = element_text(face = "bold", hjust = 0.5, vjust = -0.6)) +
  theme(axis.text.x = element_text(size = 9, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 9)) +
  theme(axis.title.x = element_text(vjust =-0.55)) +
  theme(axis.title.y = element_text(vjust =0.55)) +
  labs(title = "Top Five Reasons for Admission in 2018", caption = "Figure 8: The total number of admissions for each of the \n top five reasons for admission to the wildlife clinic in 2018")
top5_admissions18_plot
#Figure 8: Total number of admissions for each of the top five reasons for admission to the wildlife clinic in 2018.
```

```{r, include=FALSE}
#making the top5reasonsforadmission2018 in a table format
#make table with top 5 reasons, count, and percentage of total 

#arrange data frame into descending order
admissions_2018 <- admissions_2018 %>%
  arrange(desc(count))

#add percent to admissions18 table
admissions_2018 <- admissions_2018 %>%
  mutate(admissions_2018, Percent_total_intakes = count / sum (admissions_2018_count$count) * 100) 
admissions_2018

#convert admissions 18 tibble into data frame
top5_rzn18_table <- data.frame(admissions_2018)

#convert admissions 18 data frame into table
setDT(top5_rzn18_table)

#check if this was sucessful in turning data frame into data table 
is.data.table(top5_rzn18_table)

#rename columns in data table
setnames(top5_rzn18_table, c("cause_for_admission","count", "Percent_total_intakes"), 
         c("Reason Admitted", "Number of Admissions", "Percent of Total Admissions"))

#round percent column to whole numbers
top5_rzn18_table$`Percent of Total Admissions` <- round(top5_rzn18_table$`Percent of Total Admissions`)

#use flextable package
top5_rzn18_tableflex <- flextable(top5_rzn18_table)

#format table
#adjust dimensions to autofit
top5_rzn18_tableflex <- top5_rzn18_tableflex %>%
  autofit(add_w = 0, add_h = 0)

#format table
top5_rzn18_tableflex <- theme_vanilla(top5_rzn18_tableflex)
top5_rzn18_tableflex <- border_outer(top5_rzn18_tableflex)
top5_rzn18_tableflex<- set_caption(top5_rzn18_tableflex, "The total number of admissions and percentage of total admissions for each of the top five reasons for admission in 2018.")

#stats for top reasons for admission data (2018)
sum(top5_rzn18_table$`Number of Admissions`)
#784
#top 5 reasons account for 784  intakes of the 2626 total admissions for the year 2018
#top 5 reasons for intake account for 29% of all intakes in 2018

top5_rzn18_tableflex
#Table 8: The total number of admissions and percentage of total admissions for each of the top five reasons for admission in 2018.
```

```{r}
top5_rzn18_tableflex
```

```{r}
top5_admissions18_plot
```

**Results:**

According to these calculations, the five most common reasons for admission to the wildlife clinic accounted for 784 of the 2,626 total intakes in 2018, or 29 percent of all intakes. In 2018, the most common reason for admission was wildlife orphanage (20%), followed by cases of unknown injuries or trauma (5%), attacks on wildlife by domestic cats (2%), injuries to wildlife resulting in broken wings (1%), and incidents involving animal-vehicle collisions (1%).

Finally, the final step in the 2018 admissions analysis was to identify the five most severely impacted species this year, as indicated by the five species most frequently admitted to the clinic this year.

**2018 Top Five Most Frequently Admitted Species:**
```{r, include=FALSE}
#begin analysis for top 5 most common species admitted in 2018
#count top 5 most common species admitted in 2018

#top species admitted 2018
topspecies_2018<- Records_18 %>%
  group_by(species) %>%
  tally()

#count freq of all different species admitted in 2018
topspecies_2018 <- na.omit("topspecies_2018") 
topspecies_2018_count <- Records_18 %>%
  group_by(species) %>%
  summarise(count = n())

#count top 5 most common species admitted in 2018
topspecies_2018 <- na.omit("topspecies_2018") 
topspecies_2018 <- Records_18 %>%
  group_by(species) %>%
  summarise(count = n()) %>%
  na.omit("topspecies_2018") %>%
  top_n(5)
topspecies_2018

#plot top 5 species admitted in 2018
#plot in descending order on x axis
#\n seperates label or title into next line
#added formatting code to axis, title, caption and labels

top5_species18_plot <- ggplot(data = topspecies_2018, aes(x = reorder(species, -count), y = count)) + 
  geom_bar(stat = "identity", fill = "#CC3300") +
  labs(x = "Species", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 13, face = "bold", margin = margin(6, 6, 6, 6), hjust = 0.5),  plot.caption = element_text(face = "bold", hjust = 0.5, vjust = -0.8)) +
  theme(axis.text.x = element_text(size = 7, face = "bold", vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 9)) +
  theme(axis.title.x = element_text(vjust =-0.55)) +
  theme(axis.title.y = element_text(vjust =0.55)) +
  labs(title = "Top Five Most Frequently Admitted Species in 2018", caption = "Figure 9: The top five most frequently admitted species in 2018\n and the total number of clinic admissions for each.")
top5_species18_plot
#Figure 9: The top five most frequently admitted species in 2018 and the total number of clinic admissions for each.
```

```{r, include=FALSE}
#making top 5 species table with top 5 species, number admissions (count), and percent total admissions

#arrange tibble into descending order
topspecies_2018 <- topspecies_2018 %>%
  arrange(desc(count))

#add percent to tibble
topspecies_2018 <- topspecies_2018 %>%
  mutate(topspecies_2018, 'Percent of Total Admissions' = count / sum (topspecies_2018_count$count) * 100) 
topspecies_2018

#convert top species tibble into data frame
top5_species18_table <- data.frame(topspecies_2018)

#convert admissions 18 data frame into table
setDT(top5_species18_table)

#check if this was sucessful in turning data frame into data table 
is.data.table(top5_species18_table)

#rename columns in data table
setnames(top5_species18_table, c("species","count", "Percent.of.Total.Admissions"), 
         c("Species", "Number of Admissions", "Percent of Total Admissions"))

#round percent column to whole numbers
top5_species18_table$`Percent of Total Admissions` <- round(top5_species18_table$`Percent of Total Admissions`)

#use flextable package
top5_species18_tableflex <- flextable(top5_species18_table)

#format table
#adjust dimensions to autofit
top5_species18_tableflex <- top5_species18_tableflex %>%
  autofit(add_w = 0, add_h = 0)

#format table
top5_species18_tableflex <- theme_vanilla(top5_species18_tableflex)
top5_species18_tableflex <- border_outer(top5_species18_tableflex)
top5_species18_tableflex <- set_caption(top5_species18_tableflex, "The number of admissions and percent of total admissions for the top five most frequently admitted species in 2018.")
top5_species18_tableflex

#stats for top species (2018)

#sum of admissions from all top 5 common species combined
sum(top5_species18_table$'Number of Admissions')
#1186 admissions
#1186 of 2626 total admissions in 2018 are from top 5 species,
#top 5 species = 45% of all admissions in 2018

#compare admissions from top 5 species with total number of species admitted in 2018
Number_diffspecies_2018_forstats<- Records_18 %>%
  count(species)
Number_diffspecies_2018_forstats
#199
#199 different species admitted in 2018
#199 species total. Top 5 most commonly admitted species = almost 45% of all admissions

top5_species18_tableflex
#Table 9: The number of admissions and percent of total admissions for the top five most frequently admitted species in 2018.
```

```{r}
top5_species18_tableflex
```

```{r}
top5_species18_plot
```

**Results:**

According to these findings, the top five most frequently admitted species accounted for 1,186 of the total 2,626 admissions in 2018, or 45 percent of all admissions. This year, the Eastern Cotton Tail was the most frequently admitted species, accounting for 17% of all admissions, followed by the Eastern Grey Squirrel (11%), the House Sparrow (7%), the American Robin (6%), and the Herring Gull (4%). As a result, of the 199 species admitted to the clinic in 2018, admission from the top five most frequently admitted species accounted for 45 percent of all admissions.

**The 2018 individual admissions record analysis concluded with these findings. The intake records for 2019 were the following set to be examined in this analysis, as well as the final individual set of yearly records to be evaluated.**

\newpage

### 2019 Wildlife Admission Records

In this analysis, the final individual set of annual intake records to be evaluated were those from 2019. The first step in analyzing the 2019 intake data, once again, was to determine the number of monthly admissions throughout the year.

**2019 Monthly Admissions:**
```{r, include=FALSE}
#Begin 2019 data analysis
#repeat steps above for 2019, clean, # of intakes, top 5 admission reasons, top 5 species admitted

#extract important columns only
Records_19<- select(X2019Records, c(1,2,3,8,9))

#clean data 2019
Records_19 <- rename(Records_19, date = "Intake Date", species_class = "Species Class", species = "Species", city = "City Found", cause_for_admission = "Cause for Admission")

#change date format for 2019
Records_19 <- Records_19 %>%
mutate(date = mdy(date))

#Add month column from date column for 2019
Records_19$month <- month(Records_19$date)

#remove NA for 2019 data
Records_19 <- Records_19 %>%
  filter(!is.na(date))

#plotting the intakes each month against months in the year 2019
Intakebymonth_19 <- ggplot(Records_19) + aes(x = month(month, label = TRUE)) +
  geom_bar(fill = "#0099f9") +
  labs(x = "Month", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 13, face = "bold", margin = margin(6, 6, 6, 6), hjust = 0.5), plot.caption =  element_text(face = "bold", hjust = 0.5, vjust = -0.6)) +
  theme(axis.text.x = element_text(size = 9, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 9)) +
  theme(axis.title.x = element_text(vjust =-0.55)) +
  theme(axis.title.y = element_text(vjust =0.55)) +
  labs(title = "Monthly Wildlife Admissions in 2019", caption = "Figure 10: The number of monthly admissions to the wildlife clinic in 2019.")
Intakebymonth_19
#Figure 10: Monthly admissions to the wildlife clinic in 2019.
```

```{r, include=FALSE}
#2019 intake by month data into table 

#calculate total intakes per month in tibble for 2019 intakes
#monthly total calculations for intakes admission 
Monthlystats_19 <- Records_19 %>%
  group_by(month) %>%
  tally()

#count monthly intakes in 2019
Monthlystats_19 <- Records_19 %>%
  group_by(month) %>%
  summarise(count = n()) %>%
  na.omit("Monthlystats_19") %>%
  top_n(12)

#statistics of monthly 2019 admissions 

sum(Monthlystats_19$count)
#3014 total intakes in the year

mean(Monthlystats_19$count)
#mean of monthly intakes = 251, meaning the average monthly intake in 2019 is 251 intakes per month

min(Monthlystats_19$count)
#minimum intake per month = 62 , meaning the lowest number of monthly intakes in 2019 was 62  intakes in a month

max(Monthlystats_19$count)
#maximum intake per month = 537, meaning the maximum number of intakes in a month in 2019 was 537 intakes in a month

median(Monthlystats_19$count)
#median intake per month =184, meaning of the range for monthly intakes in 2019 the middle number of intakes is 184 intakes in a month

#tibble of monthly intakes, convert numeric month format to abbreviated month 
Monthlystats_19$month <- (month.abb[Monthlystats_19$month])

#convert monthly stats 19 tibble into data frame
Monthlystats_19_table <- data.frame(Monthlystats_19)

#convert monthly stats 19 data frame into table
setDT(Monthlystats_19_table)

#check if this was successful in turning data frame into data table 
is.data.table(Monthlystats_19_table)

#rename columns in data table
setnames(Monthlystats_19_table, c("month","count"), c("Month", "Admissions"))

#use flextable package
Monthlystats_19_tableflex <- flextable(Monthlystats_19_table)

#format table
Monthlystats_19_tableflex <- theme_vanilla(Monthlystats_19_tableflex)
Monthlystats_19_tableflex <- border_outer(Monthlystats_19_tableflex)
Monthlystats_19_tableflex <- border_inner_v(Monthlystats_19_tableflex)
Monthlystats_19_tableflex <- set_caption(Monthlystats_19_tableflex, "The number of monthly admissions to the wildlife clinic in 2019.")
Monthlystats_19_tableflex
#Table 10: Monthly Admissions to the wildlife clinic in 2019.
```

```{r}
Monthlystats_19_tableflex
```

```{r}
Intakebymonth_19
```






**Results:**

According to these findings, monthly admissions in 2019 followed seasonal patterns, as they had in previous years. Admission numbers peaked between May and August once more, with June being the busiest month for wildlife admissions, followed by July, which had the year's second highest admission count. The month with the highest total number of admissions was June, with 537, and the month with the lowest total number of admissions was February, with 62. Monthly admissions averaged 251 total admissions per month. Throughout the summer, the number of intakes remained close to its peak, with intakes falling just below 500 in August.

The next step, as seen in previous years' analyses, was to identify the top five reasons for clinic admission in 2019.

**2019 Top Five Reasons for Admission:**
```{r, include=FALSE}
#check class for cause for admission column before replacing values
class(Records_19$cause_for_admission)

#replace values to fix spelling and grammar errors
#replace "Orphaned Juvenile" with "Orphaned" to match other variables of the same kind
Records_19$cause_for_admission <- gsub('Orphaned juvenile', 'Orphaned', Records_19$cause_for_admission)

#replace "injury" with "Unknown trauma" to match other variables of the same kind
Records_19$cause_for_admission <- gsub('Injury', 'Unknown trauma', Records_19$cause_for_admission)

#replace "HBC" with "Hit by car" to match other variables of the same kind
Records_19$cause_for_admission <- gsub('HBC', 'Hit by car', Records_19$cause_for_admission)

#replace "Cat caught" with "Cat attack" to match other variables of the same kind
Records_19$cause_for_admission <- gsub('Cat caught', 'Cat attack', Records_19$cause_for_admission)

Records_19$cause_for_admission <- gsub('Possible HBC', 'Hit by car', Records_19$cause_for_admission)
Records_19$cause_for_admission <- gsub('Unknown', 'Unknown trauma', Records_19$cause_for_admission)
Records_19$cause_for_admission <- gsub('FX wing', 'Broken wing', Records_19$cause_for_admission)
Records_19$cause_for_admission <- gsub('Back injury', 'Unknown trauma', Records_19$cause_for_admission)

Records_19$cause_for_admission [grepl("Cat", Records_19$cause_for_admission)] <- "Cat attack"

#top reasons for admission 2019
admissions_2019 <- Records_19 %>%
  group_by(date, cause_for_admission) %>%
  tally()

#count freq of reasons for admission in 2019
admissions_2019 <- na.omit("admissions_2019") 
admissions_2019_count <- Records_19 %>%
  group_by(cause_for_admission) %>%
  summarise(count = n())

#count top 5 common reasons for admission in 2019
admissions_2019 <- na.omit("admissions_2019") 
admissions_2019 <- Records_18 %>%
  group_by(cause_for_admission) %>%
  summarise(count = n()) %>%
  na.omit("admissions_2019") %>%
  top_n(5) 

#plot top 5 common reasons for admission in 2019
#plot in descending order on x axis
#\n seperates label or title into next line
#added formatting code to axis, title, caption and labels
top5_admissions19_plot <- ggplot(data = admissions_2019, aes(x = reorder(cause_for_admission, -count), y = count)) + 
  geom_bar(stat = "identity", fill = "#69b3a2") +
  labs(x = "Reason for Admission", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 13, face = "bold", margin = margin(6, 6, 6, 6), hjust = 0.5), plot.caption = element_text(face = "bold", hjust = 0.5, vjust = -0.6)) +
  theme(axis.text.x = element_text(size = 9, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 9)) +
  theme(axis.title.x = element_text(vjust =-0.55)) +
  theme(axis.title.y = element_text(vjust =0.55)) +
  labs(title = "Top Five Reasons for Admission in 2019", caption = "Figure 11: The total number of admissions for each of the \n top five reasons for admission to the wildlife clinic in 2019.")
top5_admissions19_plot
#Figure 11: Total number of admissions for each of the top five reasons for admission to the wildlife clinic in 2019.
```

```{r, include=FALSE}
#making the top5reasonsforadmission2019 in a table format
#make table with top 5 reasons, count, and percentage of total 

#arrange data frame into descending order
admissions_2019 <- admissions_2019 %>%
  arrange(desc(count))

#add percent to admissions19 table
admissions_2019 <- admissions_2019 %>%
  mutate(admissions_2019, Percent_total_intakes = count / sum (admissions_2019_count$count) * 100) 
admissions_2019

#convert admissions 19 tibble into data frame
top5_rzn19_table <- data.frame(admissions_2019)

#convert admissions 19 data frame into table
setDT(top5_rzn19_table)

#check if this was sucessful in turning data frame into data table 
is.data.table(top5_rzn19_table)

#rename columns in data table
setnames(top5_rzn19_table, c("cause_for_admission","count", "Percent_total_intakes"), 
         c("Reason Admitted", "Number of Admissions", "Percent of Total Admissions"))

#round percent column to whole numbers
top5_rzn19_table$`Percent of Total Admissions` <- round(top5_rzn19_table$`Percent of Total Admissions`)

#use flextable package
top5_rzn19_tableflex <- flextable(top5_rzn19_table)

#format table
#adjust dimensions to autofit
top5_rzn19_tableflex <- top5_rzn19_tableflex %>%
  autofit(add_w = 0, add_h = 0)

#format table
top5_rzn19_tableflex <- theme_vanilla(top5_rzn19_tableflex)
top5_rzn19_tableflex <- border_outer(top5_rzn19_tableflex)
top5_rzn19_tableflex <- set_caption(top5_rzn19_tableflex, "The total number of admissions and percentage of total admissions for each of the top five reasons for admission in 2019.")
top5_rzn19_tableflex

#stats for top reasons for admission data (2019)
sum(top5_rzn19_table$`Number of Admissions`)
#784
#top 5 reasons account for 784 intakes of the 3014 total admissions for the year 2019
#top 5 reasons for intake account for 26% of all intakes in 2019
top5_rzn19_tableflex
#Table 11: The total number of admissions and percentage of total admissions for each of the top five reasons for admission in 2019
```

```{r}
top5_rzn19_tableflex
```

```{r}
top5_admissions19_plot
```
**Results:**

The top five primary reasons for admission to the wildlife clinic accounted for 784 of the 3014 total intakes in 2019, or 26 percent of all intakes, according to these findings. In 2019, the most common reason for admission was wildlife orphanage (17%), followed by cases of unknown injuries or trauma (5%), domestic cat attacks on wildlife (2%), wildlife injuries resulting in broken wings (1%), and incidents involving animal-vehicle collisions (1%).

Finally, the top five species that were frequently admitted to the clinic in 2019 were identified in the final segment of the 2019 annual admissions data analysis.

**2019 Top Five Most Frequently Admitted Species:**
```{r, include=FALSE}
#begin analysis for top 5 most common species admitted in 2019
#count top 5 most common species admitted in 2019

#top species admitted 2019
topspecies_2019<- Records_19 %>%
  group_by(species) %>%
  tally()

#count freq of all different species admitted in 2019
topspecies_2019 <- na.omit("topspecies_2019") 
topspecies_2019_count <- Records_19 %>%
  group_by(species) %>%
  summarise(count = n())

#count top 5 most common species admitted in 2019
topspecies_2019 <- na.omit("topspecies_2019") 
topspecies_2019 <- Records_19 %>%
  group_by(species) %>%
  summarise(count = n()) %>%
  na.omit("topspecies_2019") %>%
  top_n(5)
topspecies_2019

#plot top 5 species admitted in 2019
#plot in descending order on x axis
#\n seperates label or title into next line
#added formatting code to axis, title, caption and labels

top5_species19_plot <- ggplot(data = topspecies_2019, aes(x = reorder(species, -count), y = count)) + 
  geom_bar(stat = "identity", fill = "#CC3300") +
  labs(x = "Species", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 13, face = "bold", margin = margin(6, 6, 6, 6), hjust = 0.5),  plot.caption = element_text(face = "bold", hjust = 0.5, vjust = -0.8)) +
  theme(axis.text.x = element_text(size = 7, face = "bold", vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 9)) +
  theme(axis.title.x = element_text(vjust =-0.55)) +
  theme(axis.title.y = element_text(vjust =0.55)) +
  labs(title = "Top Five Most Frequently Admitted Species in 2019", caption = "Figure 12: The top five most frequently admitted species in 2019\n and the total number of clinic admissions for each.")
top5_species19_plot
#Figure 12: The top five most frequently admitted species in 2019 and the total number of clinic admissions for each.
```

```{r, include=FALSE}
#making top 5 species table with top 5 species, number admissions (count), and percent total admissions

#arrange tibble into descending order
topspecies_2019 <- topspecies_2019 %>%
  arrange(desc(count))

#add percent to tibble
topspecies_2019 <- topspecies_2019 %>%
  mutate(topspecies_2019, 'Percent of Total Admissions' = count / sum (topspecies_2019_count$count) * 100) 
topspecies_2019

#convert top species tibble into data frame
top5_species19_table <- data.frame(topspecies_2019)

#convert admissions 19 data frame into table
setDT(top5_species19_table)

#check if this was successful in turning data frame into data table 
is.data.table(top5_species19_table)

#rename columns in data table
setnames(top5_species19_table, c("species","count", "Percent.of.Total.Admissions"), 
         c("Species", "Number of Admissions", "Percent of Total Admissions"))

#round percent column to whole numbers
top5_species19_table$`Percent of Total Admissions` <- round(top5_species19_table$`Percent of Total Admissions`)

#use flextable package
top5_species19_tableflex <- flextable(top5_species19_table)

#format table
#adjust dimensions to autofit
top5_species19_tableflex <- top5_species19_tableflex %>%
  autofit(add_w = 0, add_h = 0)

#format table
top5_species19_tableflex <- theme_vanilla(top5_species19_tableflex)
top5_species19_tableflex <- border_outer(top5_species19_tableflex)
top5_species19_tableflex <- set_caption(top5_species19_tableflex, "The number of admissions and percent of total admissions for the top five most frequently admitted species in 2019.")

#stats for top species (2019)
#sum of admissions from all top 5 common species combined
sum(top5_species19_table$'Number of Admissions')
#1400 admissions
#1400 of 3014 total admissions in 2019 are from top 5 species,
#top 5 species = 46% of all admissions in 2019

#compare admissions from top 5 species with total number of species admitted in 2019
Number_diffspecies_2019_forstats<- Records_19 %>%
  count(species)
Number_diffspecies_2019_forstats
#169
#169 different species admitted in 2019
#169 species total. Top 5 most commonly admitted species = almost 50% of all admissions
top5_species19_tableflex
#Table 12: The number of admissions and percent of total admissions for the top five most frequently admitted species in 2019.
```

```{r}
top5_species19_tableflex
```

```{r}
top5_species19_plot
```

**Results:**

In 2019, the top five most commonly admitted species accounted for 1,400 of the total 3,014 admissions, or 46 percent of all admissions. The Eastern Cotton Tail was the most frequently admitted species this year, accounting for 18% of all admissions, followed by the Eastern Grey Squirrel (12%), American Robin (6%), House Sparrow (5%), and Herring Gull (5%). According to these findings, of the 169 different species admitted to the clinic in 2019, the top five most frequently admitted species accounted for 46 percent of all admissions overall.

**These findings brought the section of this analysis specific to each set of individual yearly intake records to a close, completing the yearly intake analyses for 2014, 2016, 2018, and 2019.**

Following this, for each of the figures generated from the individual yearly intake records analyses, correlating figures for all four years of data were placed side by side in order to gain perspective on how trends in clinic admissions may or may not change with time.
\newpage

### Side-by-Side Wildlife Admission Records 

The first figures to be compared from the yearly record analyses were those generated by the number of monthly intakes for each month within each year of intake data.

**Side-by-Side Monthly Admissions, 2014-2019, (Figure 13):**

```{r, include=FALSE}
#start side by side comparison for all four years
#compare intakes monthly, top species, and top reasons for admission between all 4 years
#monthly intakes all years
#rename plots for monthly intakes and remove some aspects of plot
#2019 plot
Intakebymonth_19_grid <- ggplot(Records_19) + aes(x = month(month, label = TRUE)) +
  geom_bar(fill = "#0099f9") +
  labs(x = "Month", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 9, margin = margin(6, 6, 6, 6), hjust = 0.5)) +
  theme(axis.text.x = element_text(size = 6, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 6)) +
  theme(axis.title.x = element_text(size = 6, vjust =-0.55)) +
  theme(axis.title.y = element_text(size = 6, vjust =0.55)) +
  labs(title = "Monthly Wildlife Admissions in 2019")
Intakebymonth_19_grid

#2018 plot
#plotting the intakes each month against months in the year 2018
Intakebymonth_18_grid <- ggplot(Records_18) + aes(x = month(month, label = TRUE)) +
  geom_bar(fill = "#0099f9") +
  labs(x = "Month", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 9,  margin = margin(6, 6, 6, 6), hjust = 0.5)) +
  theme(axis.text.x = element_text(size = 6, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 6)) +
  theme(axis.title.x = element_text(size = 6, vjust =-0.55)) +
  theme(axis.title.y = element_text(size = 6, vjust =0.55)) +
  labs(title = "Monthly Wildlife Admissions in 2018")
Intakebymonth_18_grid

#2016
Intakebymonth_16_grid <- ggplot(Records_16) + aes(x = month(month, label = TRUE)) +
  geom_bar(fill = "#0099f9") +
  labs(x = "Month", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 9, margin = margin(6, 6, 6, 6), hjust = 0.5)) +
  theme(axis.text.x = element_text(size = 6, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 6)) +
  theme(axis.title.x = element_text(size = 6, vjust =-0.55)) +
  theme(axis.title.y = element_text(size = 6, vjust =0.55)) +
  labs(title = "Monthly Wildlife Admissions in 2016")
Intakebymonth_16_grid

#2014
updated_14_intakebymonth_grid <- ggplot(Records_14) + aes(x = month(month, label = TRUE)) + 
  geom_bar(fill = "#0099f9") +
  labs(x = "Month", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 9, margin = margin(6, 6, 6, 6), hjust = 0.5)) +
  theme(axis.text.x = element_text(size = 6, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 6)) +
  theme(axis.title.x = element_text(size = 6, vjust =-0.55)) +
  theme(axis.title.y = element_text(size = 6, vjust =0.55)) +
  labs(title = "Monthly Wildlife Admissions in 2014") 
updated_14_intakebymonth_grid

Monthlyintakes_allyears <- grid.arrange(updated_14_intakebymonth_grid, Intakebymonth_16_grid, Intakebymonth_18_grid, Intakebymonth_19_grid, nrow = 2, ncol = 2, top = "Monthly Admissions by Year")
#Figure 13: Monthly Admissions by Year, 2014-2019
```

```{r,echo=FALSE, results="asis", warning=FALSE, message=FALSE}
grid.arrange(Monthlyintakes_allyears)
```
\newpage

Following this, the top five reasons for admission plots from each yearly analysis were formatted side by side in order to graphically display trends in the top five most common reasons for clinic admission from 2014 to 2019.

**Side-by-Side Top Five Reasons for Admission, 2014-2019, (Figure 14):**
```{r, include=FALSE}
#top reasons for admission, adjust plots
top5_admissions14_plot_grid <- ggplot(data = admissions_2014, aes(x = reorder(cause_for_admission, -count), y = count)) + 
  geom_bar(stat = "identity", fill = "#69b3a2") +
  labs(x = "Reason for Admission", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 11, margin = margin(6, 6, 6, 6), hjust = 0.5)) +
  theme(axis.text.x = element_text(size = 6, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 6)) +
  theme(axis.title.x = element_text(size = 6, vjust =-0.55)) +
  theme(axis.title.y = element_text(size = 6, vjust =0.55)) +
  labs(title = "Top Five Reasons for Admission in 2014")
top5_admissions14_plot_grid

#2016 plot
top5_admissions16_plot_grid <- ggplot(data = admissions_2016, aes(x = reorder(cause_for_admission, -count), y = count)) + 
  geom_bar(stat = "identity", fill = "#69b3a2") +
  labs(x = "Reason for Admission", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 11, margin = margin(6, 6, 6, 6), hjust = 0.5)) +
  theme(axis.text.x = element_text(size = 6, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 6)) +
  theme(axis.title.x = element_text(size = 6, vjust =-0.55)) +
  theme(axis.title.y = element_text(size = 6, vjust =0.55)) +
  labs(title = "Top Five Reasons for Admission in 2016")
top5_admissions16_plot_grid

#2018 plot
top5_admissions18_plot_grid <- ggplot(data = admissions_2018, aes(x = reorder(cause_for_admission, -count), y = count)) + 
  geom_bar(stat = "identity", fill = "#69b3a2") +
  labs(x = "Reason for Admission", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 11, margin = margin(6, 6, 6, 6), hjust = 0.5)) +
  theme(axis.text.x = element_text(size = 6, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 6)) +
  theme(axis.title.x = element_text(size = 6, vjust =-0.55)) +
  theme(axis.title.y = element_text(size = 6, vjust =0.55)) +
  labs(title = "Top Five Reasons for Admission in 2018")
top5_admissions18_plot_grid

#2019 plot
top5_admissions19_plot_grid <- ggplot(data = admissions_2019, aes(x = reorder(cause_for_admission, -count), y = count)) + 
  geom_bar(stat = "identity", fill = "#69b3a2") +
  labs(x = "Reason for Admission", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 11, margin = margin(6, 6, 6, 6), hjust = 0.5)) +
  theme(axis.text.x = element_text(size = 6, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 6)) +
  theme(axis.title.x = element_text(size = 6, vjust =-0.55)) +
  theme(axis.title.y = element_text(size = 6, vjust =0.55)) +
  labs(title = "Top Five Reasons for Admission in 2019")
top5_admissions19_plot_grid
```

```{r, include=FALSE}
#top rzns admission all years
Top5rzns_allyears <- grid.arrange(top5_admissions14_plot_grid, top5_admissions16_plot_grid, top5_admissions18_plot_grid, top5_admissions19_plot_grid, nrow = 2, ncol = 2, top = "Top Five Reasons for Admission by Year")
Top5rzns_allyears
#Figure 14: Top Five Reasons for Admission by Year, 2014-2019.
```

```{r,echo=FALSE, results="asis", warning=FALSE, message=FALSE}
grid.arrange(Top5rzns_allyears)
```

\newpage

The final side-by-side comparison in this analysis was for each figure showing the top five most frequently admitted species in each year.

**Side-by-Side Top Five Most Frequently Admitted Species, 2014-2019, (Figure 15):**
```{r, include=FALSE}
#top reasons for admission, adjust plots
#2014 plot
top5_species14_plot_grid <- ggplot(data = topspecies_2014, aes(x = reorder(species, -count), y = count)) + 
  geom_bar(stat = "identity", fill = "#CC3300") +
  labs(x = "Species", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 9, margin = margin(6, 6, 6, 6), hjust = 0.5)) +
  theme(axis.text.x = element_text(size = 4, face = "bold", vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 6)) +
  theme(axis.title.x = element_text(size = 6, vjust =-0.55)) +
  theme(axis.title.y = element_text(size = 6, vjust =0.55)) +
  labs(title = "Top Five Most Frequently Admitted Species in 2014")
top5_species14_plot_grid

#2016 plot
top5_species16_plot_grid <- ggplot(data = topspecies_2016, aes(x = reorder(species, -count), y = count)) + 
  geom_bar(stat = "identity", fill = "#CC3300") +
  labs(x = "Species", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 9, margin = margin(6, 6, 6, 6), hjust = 0.5)) +
  theme(axis.text.x = element_text(size = 4, face = "bold", vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 6)) +
  theme(axis.title.x = element_text(size = 6, vjust =-0.55)) +
  theme(axis.title.y = element_text(size = 6, vjust =0.55)) +
  labs(title = "Top Five Most Frequently Admitted Species in 2016")
top5_species16_plot_grid

#2018 plot
top5_species18_plot_grid <- ggplot(data = topspecies_2018, aes(x = reorder(species, -count), y = count)) + 
  geom_bar(stat = "identity", fill = "#CC3300") +
  labs(x = "Species", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 9, margin = margin(6, 6, 6, 6), hjust = 0.5)) +
  theme(axis.text.x = element_text(size = 4, face = "bold", vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 6)) +
  theme(axis.title.x = element_text(size = 6, vjust =-0.55)) +
  theme(axis.title.y = element_text(size = 6, vjust =0.55)) +
  labs(title = "Top Five Most Frequently Admitted Species in 2018")
top5_species18_plot_grid
  
#2019 plot
top5_species19_plot_grid <- ggplot(data = topspecies_2019, aes(x = reorder(species, -count), y = count)) + 
  geom_bar(stat = "identity", fill = "#CC3300") +
  labs(x = "Species", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 9, margin = margin(6, 6, 6, 6), hjust = 0.5)) +
  theme(axis.text.x = element_text(size = 4, face = "bold",  vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 6)) +
  theme(axis.title.x = element_text(size = 6, vjust =-0.55)) +
  theme(axis.title.y = element_text(size = 6, vjust =0.55)) +
  labs(title = "Top Five Most Frequently Admitted Species in 2019")
top5_species19_plot_grid
```

```{r, include=FALSE}
#top species all years
Top5species_allyears <- grid.arrange(top5_species14_plot_grid, top5_species16_plot_grid, top5_species18_plot_grid, top5_species19_plot_grid, nrow = 2, ncol = 2, top = "Top Five Common Species by year")
Top5species_allyears
#Figure 15: Top Five Common Species by Year, 2014-2019.
```

```{r,echo=FALSE, results="asis", warning=FALSE, message=FALSE}
grid.arrange(Top5species_allyears)
```

**This concluded the side-by-side comparison of the yearly admissions analyses. Following this, all of the intake records from each year were merged into a single data set to analyze admissions trends over time in a different format.**

\newpage

### Merged Wildlife Admission Records

The annual intake records from each year, including 2014, 2016, 2018, and 2019, were combined into a single data file to calculate the total number of admissions across all four years of data in the study period. This merged data set was used to calculate both the number of admissions in each month across all data years and the number of admissions per year across all four years. 

**Combined Total Monthly Admissions, 2014-2019:**
```{r, include = FALSE}
#merging data
merged_intake <- merge(Records_14, Records_16, by=c ("month"))
merged_intake2 <- merge(Records_18, Records_19, by=c ("month"))
merge <- left_join(merged_intake, merged_intake2)

#plotting the intakes each year
Intakebymonth_all <- ggplot(merge) + aes(x = month(month, label = TRUE)) +
  geom_bar(fill = "#0099f9") +
  labs(x = "Month", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 13, face = "bold", margin = margin(6, 6, 6, 6), hjust = 0.5), plot.caption =  element_text(face = "bold", hjust = 0.5, vjust = -0.6)) +
  theme(axis.text.x = element_text(size = 9, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 9)) +
  theme(axis.title.x = element_text(vjust =-0.55)) +
  theme(axis.title.y = element_text(vjust =0.55)) +
  scale_y_continuous(label = label_number_si()) +
  labs(title = "Combined Monthly Admissions, 2014-2019", caption = "Figure 16: Total monthly admissions to the wildlife clinic, 2014 to 2019.")
Intakebymonth_all
#Figure 16: Combined Total Wildlife Clinic Admissions by Month, 2014-2019
```

```{r, include = FALSE}
#2014-2019 intake by month data 

#calculate total intakes per month in tibble for all years intakes
#monthly total calculations for intakes admission 
Monthlystats_all <- merge %>%
  group_by(month) %>%
  tally()

#count monthly intakes all years
Monthlystats_all <- merge %>%
  group_by(month) %>%
  summarise(count = n()) %>%
  na.omit("Monthlystats_all") %>%
  top_n(12)

#tibble of monthly intakes, convert numeric month format to abbreviated month 
Monthlystats_all$month <- (month.abb[Monthlystats_all$month])

#convert monthly stats tibble into data frame
Monthlystats_all_table <- data.frame(Monthlystats_all)

#convert monthly stats data frame into table
setDT(Monthlystats_all_table)

#check if this was sucessful in turning data frame into data table 
is.data.table(Monthlystats_all_table)

#rename columns in data table
setnames(Monthlystats_all_table, c("month","count"), c("Month", "Admissions"))

#use flextable package
Monthlystats_all_tableflex <- flextable(Monthlystats_all_table)

#format table
Monthlystats_all_tableflex <- theme_vanilla(Monthlystats_all_tableflex)
Monthlystats_all_tableflex <- border_outer(Monthlystats_all_tableflex)
Monthlystats_all_tableflex <- border_inner_v(Monthlystats_all_tableflex)
Monthlystats_all_tableflex <- set_caption(Monthlystats_all_tableflex, "Total monthly admissions to the wildlife clinic, 2014-2019.")

#statistics of monthly admissions across all years
sum(Monthlystats_all$count)
#804332 total intakes across the years 2014, 2016, 2018, 2019

mean(Monthlystats_all$count)
#mean of monthly intakes = 67027, meaning across these four years of data the wildlife rehab averaged 67027 intakes

min(Monthlystats_all$count)
#minimum intake per month = 1558 , meaning the month with the least intakes per month across all data was December with a combined 1558 intakes from all four years

max(Monthlystats_all$count)
#maximum intake per month = 278006, meaning the month with the most intakes per month across all data was June, with 278006 total intakes per month combined across all four years

median(Monthlystats_all$count)
#median intake per month = 21875, meaning of the range for monthly intakes across all years of data or the middle number of intakes was 21875 intakes in a month
#statistics of monthly admissions across all years

sum(Monthlystats_all$count)
#804332 total intakes across the years 2014, 2016, 2018, 2019

Monthlystats_all_tableflex
#Table 13: Monthly Wildlife Clinic Admissions by Date, 2014-2019
```

```{r}
Monthlystats_all_tableflex
```

```{r}
Intakebymonth_all
```
\newpage

**Total Yearly Admissions, 2014-2019:**
```{r, include=FALSE}

#rbind all records data to make next plots
#remove extra column in Rec14
Records_14 <- select(Records_14, c(1,2,3,5,6,7))

#rbind data
Allyearsdata <- rbind(Records_14, Records_16, Records_18, Records_19)
#Add Year column to all data combined 
Allyearsdata$Year <- as.character(year(Allyearsdata$date))
Allyearsdata <- select(Allyearsdata, c(7))
#count observations in each year
Allyearsdata <- Allyearsdata %>%
  filter(Year != 2000) %>%
  filter(Year != 2001) %>%
  filter(Year != 2013) %>%
  filter(Year != 2015) %>%
  filter(Year != 2017)
Allyearsdata %>%
  count(Year)

Intakebyyear <- ggplot(Allyearsdata) + aes(x = Year) +
  geom_bar(fill = "#0099f9") +
  labs(x = "Year", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 13, face = "bold", margin = margin(6, 6, 6, 6), hjust = 0.5), plot.caption =  element_text(face = "bold", hjust = 0.5, vjust = -0.6)) +
  theme(axis.text.x = element_text(size = 9, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 9)) +
  theme(axis.title.x = element_text(vjust =-0.55)) +
  theme(axis.title.y = element_text(vjust =0.55)) +
  labs(title = "Yearly Wildlife Admissions, 2014-2019", caption = "Figure 17: Total yearly admissions to the wildlife clinic, 2014 to 2019.")
Intakebyyear
#Figure 17: Yearly Admissions to the Clinic, 2014-2019.**
```

```{r}
Intakebyyear
```
\newpage

Following this, the top five reasons for clinic admissions from all years of data were examined.

**Top Five Reasons for Admission, 2014-2019:**
```{r, include=FALSE}
#all years top reasons 
#rbind data
Allyearsdata1 <- rbind(Records_14, Records_16, Records_18, Records_19)

#Add Year column to all data combined 
Allyearsdata1$Year <- as.character(year(Allyearsdata1$date))

#count observations in each year
Allyearsdata1 <- Allyearsdata1 %>%
  filter(Year != 2000) %>%
  filter(Year != 2001) %>%
  filter(Year != 2013) %>%
  filter(Year != 2015) %>%
  filter(Year != 2017)

#top reasons for admission all years
merge_admissions <- Allyearsdata1 %>%
  group_by(date, cause_for_admission) %>%
  tally()

#count top 5 common reasons for admission in all years
merge_admissions <- merge_admissions %>%
  group_by(cause_for_admission) %>%
  summarise(count = n()) %>%
  na.omit("merge_admissions") %>%
  top_n(5)

#plot top 5 common reasons for admission in 2019
#plot in descending order on x axis
#\n seperates label or title into next line
#added formatting code to axis, title, caption and labels
Merge_admissions_plot <- ggplot(data = merge_admissions, aes(x = reorder(cause_for_admission, -count), y = count)) + 
  geom_bar(stat = "identity", fill = "#69b3a2") +
  labs(x = "Reason for Admission", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 13, face = "bold", margin = margin(6, 6, 6, 6), hjust = 0.5), plot.caption = element_text(face = "bold", hjust = 0.5, vjust = -0.6)) +
  theme(axis.text.x = element_text(size = 9, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 9)) +
  theme(axis.title.x = element_text(vjust =-0.55)) +
  theme(axis.title.y = element_text(vjust =0.55)) +
labs(title = "Top Five Reasons for Admission, by Date 2014-2019", caption = "Figure 18: The total number of admissions for each of the \n top five reasons for admission to the wildlife clinic, by date from 2014-2019.")
Merge_admissions_plot
#Figure 18: The total number of admissions and percentage of total admissions for each of the top five reasons for admission, by date from 2014-2019.
```

```{r}
Merge_admissions_plot
```
\newpage

The final stage of the merged data analysis involved determining the top five species most frequently admitted across all years of data in the study. *(Due to the increased sample size in this section of the data analysis, the number of most frequently admitted species was reduced from five to three in this section of the analysis, allowing for a better representation of the species truly at greatest risk- as these results indicate.)*


**Top Three Most Frequently Admitted Species, 2014-2019:**
```{r, include=FALSE}
#all years top species
#rbind data
Allyearsdata2 <- rbind(Records_14, Records_16, Records_18, Records_19)
#replace values to fix spelling and grammar errors
#replace "Eastern Grey Squirrel" with "Eastern Gray Squirrel" to match other variables of the same kind
Allyearsdata2$cause_for_admission <- gsub('Eastern Grey Squirrel', 'Eastern Gray Squirrel', Allyearsdata2$cause_for_admission)
Allyearsdata2$cause_for_admission [grepl("Eastern Grey Squirrel", Allyearsdata2$cause_for_admission)] <- "Eastern Gray Squirrel"
#Add Year column to all data combined 
Allyearsdata2$Year <- as.character(year(Allyearsdata2$date))

#count observations in each year
Allyearsdata2 <- Allyearsdata2 %>%
  filter(Year != 2000) %>%
  filter(Year != 2001) %>%
  filter(Year != 2013) %>%
  filter(Year != 2015) %>%
  filter(Year != 2017)

Allyearsdata2$cause_for_admission [grepl("Eastern Grey Squirrel", Allyearsdata2$cause_for_admission)] <- "Eastern Gray Squirrel"

#top species all years
merge_species <- Allyearsdata2 %>%
  group_by(species) %>%
  tally()

#count top 5 common species in all years
merge_species <- Allyearsdata2 %>%
  group_by(species) %>%
  summarise(count = n()) %>%
  na.omit("merge_species") %>%
  top_n(3)

#plot top 5 common reasons for admission all years
#plot in descending order on x axis
#\n seperates label or title into next line
#added formatting code to axis, title, caption and labels
merge_species_plot <- ggplot(data = merge_species, aes(x = reorder(species, -count), y = count)) + 
  geom_bar(stat = "identity", fill = "#CC3300") +
  labs(x = "Species", y = "Number of Admissions") +
  theme_bw() +
  theme(plot.title = element_text(size = 13, face = "bold", margin = margin(6, 6, 6, 6), hjust = 0.5), plot.caption = element_text(face = "bold", hjust = 0.5, vjust = -0.6)) +
  theme(axis.text.x = element_text(size = 9, vjust = 0.5)) +
  theme(axis.text.y = element_text(size = 9)) +
  theme(axis.title.x = element_text(vjust =-0.55)) +
  theme(axis.title.y = element_text(vjust =0.55)) +
  labs(title = "Top Three Most Frequently Admitted Species, 2014 - 2019", caption = "Figure 19: The top three most frequently admitted species and the total \n number of clinic admissions for each, 2014-2019.")
merge_species_plot
```

```{r}
merge_species_plot
```
\newpage

**The final section of this analysis sought to determine which, if any, locations in Rhode Island serve as hotspots for wildlife injury and displacement.This was investigated by using the mapping function to create a Rhode Island state map that displayed the most frequent locations from which animals were transported to the clinic over the course of all years of data.**

### Mapping Rhode Island Hot-Spot Locations, All Data Combined, 2014-2019: 
```{r, include=FALSE}
#moving on to map of hot spot locations in RI 
#mapping towns with top admission numbers
#all years top towns species admitted from 
#rbind data from all years
Allyearsdata_towns <- rbind(Records_14, Records_16, Records_18, Records_19)
#top towns species admitted from, group by intake city
merge_admissions_towns <- Allyearsdata_towns %>%
  group_by(city) %>%
  tally()

#count top 10 towns in terms of admissions
merge_admissions_towns <- Allyearsdata_towns %>%
  group_by(city) %>%
  summarise(count = n()) %>%
  na.omit("merge_admissions_towns") %>%
  top_n(10)

#mapping
#making the base map 
#map of states
state <- map_data("state")

#subset for RI only 
rhodeisland <- subset(state, region=="rhode island")

#map of counties
counties <- map_data("county")

#subset for counties in RI 
ri_county <- subset(counties, region=="rhode island")

#learning how to use map packages
#trying to map RI 
ri_map <- map_data("state") %>%
  filter(region == "Rhode Island")
#trying to map counties in RI 
ri_mapcounties <- map_data("county") %>%
  filter(region == "rhode island")

#try map out with counties
ri_mapcounties <- ggplot(data = ri_mapcounties,
                         mapping = aes(x = long, y = lat, group=group)) 

state <- map_data("state")
rhodeisland <- subset(state, region=="rhode island")
counties <- map_data("county")
ri_county <- subset(counties, region=="rhode island")

#trial map, not in final report
ri_mapped <- ggplot(data=rhodeisland, mapping=aes(x=long, y=lat, group=group)) +  
  coord_fixed(1.3) + 
  geom_polygon(color="black", fill="gray") + 
  geom_polygon(data=ri_county, fill=NA, color="white") +
  geom_polygon(color="black", fill=NA) + 
  ggtitle('Rhode Island Map with Counties') + 
  theme(axis.title.x=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank(),
        axis.title.y=element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank())
ri_mapped

#RI county map 
#not included in final report, trial map 
ri_mapped <- ggplot(data=rhodeisland, mapping=aes(x=long, y=lat, group=group)) +  
  coord_fixed(1.3) + 
  geom_polygon(color="black", fill="gray") + 
  geom_polygon(data=ri_county, fill=NA, color="white") +
  geom_polygon(color="black", fill=NA) + 
  ggtitle('Rhode Island Map with Counties') + 
  theme(axis.title.x=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank(),
        axis.title.y=element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank())
ri_mapped

#trial making base map with new imported data set listing lat and long of top ten towns in RI
#not included in final report
ri_mapped3 <- ggplot() +
  geom_polygon(data=rhodeisland,  aes(x=long, y=lat, group = group),color="white", fill="grey92") +  
  geom_point(data=Intakebytown_mappingdata, aes(x=Lon, y=Lat, size = Intakes), color="black") +
  scale_size(name="", range = c(2, 10)) + 
  guides(size=guide_legend("Intakes per top ten towns 2014-2019")) +
  theme_void() 
ri_mapped3

#replace names in data to help with map labels
Intakebytown_mappingdata$Town <- gsub('Coventry, RI, USA', 'Coventry', 
                                      Intakebytown_mappingdata$Town)
Intakebytown_mappingdata$Town <- gsub('Cranston, RI, USA', 'Cranston', 
                                      Intakebytown_mappingdata$Town)
Intakebytown_mappingdata$Town <- gsub('East Greenwich, RI, USA', 'East Greenwich', 
                                      Intakebytown_mappingdata$Town)
Intakebytown_mappingdata$Town <- gsub('Narragansett, RI, USA', 'Narragansett', 
                                      Intakebytown_mappingdata$Town)
Intakebytown_mappingdata$Town <- gsub('Newport, RI, USA', 'Newport', 
                                      Intakebytown_mappingdata$Town)
Intakebytown_mappingdata$Town <- gsub('North Kingstown, RI, USA', 'North Kingstown', 
                                      Intakebytown_mappingdata$Town)
Intakebytown_mappingdata$Town <- gsub('Providence, RI, USA', 'Providence', 
                                      Intakebytown_mappingdata$Town)
Intakebytown_mappingdata$Town <- gsub('Rhode Island, USA', 'Wakefield', 
                                      Intakebytown_mappingdata$Town)
Intakebytown_mappingdata$Town <- gsub('Warwick, RI, USA', 'Warwick', 
                                      Intakebytown_mappingdata$Town)
Intakebytown_mappingdata$Town <- gsub('Westerly, RI, USA', 'Westerly', 
                                      Intakebytown_mappingdata$Town)

#map of top ten towns for admission numbers 2014-2019
ri_mapped5 <- ggplot() +
  geom_polygon(data=rhodeisland,  aes(x=long, y=lat, group = group),color="white", fill="grey92") + 
  coord_fixed(1.3) +
  geom_point(data=Intakebytown_mappingdata, aes(x=Lon, y=Lat, size = Intakes), color="red") +
  scale_size(name="", range = c(2, 8)) + 
  guides(size=guide_legend("Total Admissions")) +
  geom_text_repel(data=Intakebytown_mappingdata, aes(Lon, Lat, label = Town), size=2.5) +
  theme_void() +
  labs(title =  "Rhode Island Towns with Leading Admission Rates, 2014-2019", 
     caption = "Figure 20: The number of admissions from each of the top ten towns
     in Rhode Island with the highest admission rates.") +
  theme(plot.title = element_text(size = 11, face = "bold", margin = margin(6, 6, 6, 6), hjust = 0.5), 
        plot.caption =  element_text(face = "bold", hjust = 0.5)) 
ri_mapped5
```

```{r}
ri_mapped5
```

